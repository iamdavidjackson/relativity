!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jQuery")):"function"==typeof define&&define.amd?define(["jQuery"],e):"object"==typeof exports?exports.Relativity=e(require("jQuery")):t.Relativity=e(t.jQuery)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){function n(t){this.prefixedTransform=this.vendorPrefix("transform"),this._defaultOptions={autoInit:!0,$container:"body",containerSelector:".relativity-container",ieBrowserVersionSelector:"body",onOffSelector:"html",mobileSupport:!0,ie8Support:!1,ie9Support:!0,positionProperty:"transform",supports3D:!0,containers:[]},this.init(t)}var o=i(1);n.prototype={initVariables:function(t){this.options=this.extend(this._defaultOptions,t),this.containers=this.options.containers,this.isIE8=o(this.options.ieBrowserVersionSelector).hasClass("lt-ie9"),this.isIE9=!this.isIE8&&o(this.options.ieBrowserVersionSelector).hasClass("lt-ie10"),this.$container=o(this.options.$container)},init:function(t){this.initVariables(t),this.options.autoInit&&this.enable()},enable:function(){this.isSupported()?(o(this.options.onOffSelector).addClass("relativity-on"),this.initEvents(),this.updateVariables(),this.updateElements(!0)):o(this.options.onOffSelector).addClass("relativity-off")},disable:function(){this.removeEvents(),o(this.options.onOffSelector).addClass("relativity-off")},isSupported:function(){var t=!0,e={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOSlg:function(){return navigator.userAgent.match(/iPad/i)},iOSsm:function(){return navigator.userAgent.match(/iPhone|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return e.Android()||e.BlackBerry()||e.iOSsm()||e.Opera()||e.Windows()}};if(e.any()&&(t=!1,/iP(hone|od|ad)/.test(navigator.platform))){var i=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=[parseInt(i[1],10),parseInt(i[2],10),parseInt(i[3]||0,10)];n>=8&&(t=!0)}return t},updateVariables:function(){var t=[];this.viewPortSize=this.getViewportSize(),this.viewPortOffset=this.getViewportOffset();var e=this.options.containers.length;if(e>0)for(var i=0;e>i;i++){for(var n=this.options.containers[i],r=o(n.selector),s=r.offset().top,a=r.height(),l=s+a,h=n.elements.length,p=[],c=0;h>c;c++){var f=n.elements[c],u=r.find(f.selector);p.push({$element:u,movement:f.movement,options:f.options,originalLeft:u.position().left,originalTop:u.position().top,originalWidth:u.width(),originalHeight:u.height()})}t.push({top:s,bottom:l,height:a,$element:r,elements:p,elementsCount:p.length})}else this.$container=o(this.options.$container),this.$containers=this.$container.find(this.options.containerSelector),this.$containers.each(function(e,i){var n=o(i),s=n.offset().top,a=n.height(),l=s+a,h=n.find("[data-relativity-movement]"),p=[];h.each(function(t,e){var i=o(e);p.push({$element:i,movement:i.attr("data-relativity-movement"),options:i.data(),originalLeft:u.position().left,originalTop:u.position().top,originalWidth:u.width(),originalHeight:u.height()})}),t.push({top:s,bottom:l,height:a,$element:r,elements:p,elementsCount:p.length})});this.containers=t,this.containersLength=this.containers.length},updateElements:function(t){var e=this.getViewportOffset(),i=e.top,n=i+this.viewPortSize.height,o="down";if(this.viewPortOffset.top!==e.top||t){this.viewPortOffset.top>e.top&&(o="up"),this.viewPortOffset=e;for(var r=0;r<this.containersLength;r++){var s=this.containers[r];if(s.top>i&&s.top<n||s.bottom>i&&s.bottom<n||s.top<i&&s.bottom>n){var a=i-s.height,l=n,h=l-a,p=s.top-a,c=1-p/h;s.onscreen=!0,this.triggerContainerOnScreen(s,c)}else s.onscreen&&(s.$element.trigger("relativity:onscreen",s,"down"===o?1:0),this.triggerContainerOffScreen(s,o),s.onscreen=!1)}}},triggerContainerOnScreen:function(t,e){t.$element.addClass("relativity-onscreen"),t.$element.trigger("relativity:onscreen",t,e);for(var i=0;i<t.elementsCount;i++){var n=t.elements[i],o=n.movement,r="onMovement"+o.charAt(0).toUpperCase()+o.slice(1).toLowerCase(),s=this[r];if("function"==typeof s)return s.apply(this,[n,e]);console.log("no method available")}},triggerContainerOffScreen:function(t,e){t.$element.removeClass("relativity-onscreen"),t.$element.trigger("relativity:offscreen",t,e)},initEvents:function(){o(document).on("relativity:update",o.proxy(this.onUpdateRelativity,this)),this.isIE8&&this.options.ie8Support||this.isIE9&&this.options.ie9Support?this.requestAnimFrameLoop():o(window).scroll(o.proxy(this.onWindowScroll,this)),o(window).resize(o.proxy(this.onUpdateRelativity,this))},onWindowScroll:function(t){this.updateElements()},onUpdateRelativity:function(t){this.updateVariables(),this.updateElements(!0)},requestAnimFrameLoop:function(){this.updateElements(),window.requestAnimationFrame(this.requestAnimFrameLoop.bind(this))},onMovementLeft:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalLeft-n;"position"===this.positionProperty?this.setLeft(i,o):this.setTransform(i,o,t.originalLeft,0,0)},onMovementRight:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalLeft+n;"position"==this.positionProperty?this.setLeft(i,o):this.setTransform(i,o,t.originalLeft,0,0)},onMovementUp:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalTop-n;"position"==this.positionProperty?this.setTop(i,o):this.setTransform(i,0,0,o,t.originalTop)},onMovementDown:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalTop+n;"position"==this.positionProperty?this.setTop(i,o):this.setTransform(i,0,0,o,t.originalTop)},onMovementScale:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalWidth+n,r=t.originalHeight*(o/t.originalWidth);i.css("width",o+"px"),i.css("height",r+"px")},onMovementReveal:function(t,e){var i=t.$element,n=this.getDataAttributes(i);e>=n.triggerPoint?i.css("opacity","1"):i.css("opacity","0")},onMovementWiden:function(t,e){var i=t.$element,n=this.calculateDelta(t,e),o=t.originalWidth+n;i.css("width",o)},getViewportSize:function(){var t,e,i={height:window.innerHeight,width:window.innerWidth};return i.height||(t=document.compatMode,!t&&o.support.boxModel||(e="CSS1Compat"===t?document.documentElement:document.body,i={height:e.clientHeight,width:e.clientWidth})),i},getViewportOffset:function(){return{top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft}},setLeft:function(t,e){t.css("left",e)},setTop:function(t,e){t.css("top",e)},setTransform:function(t,e,i,n,o){this.options.supports3D?t.css(this.prefixedTransform,"translate3d("+(e-i)+"px, "+(n-o)+"px, 0)"):t.css(this.prefixedTransform,"translate("+(e-i)+"px, "+(n-o)+"px)")},calculateDelta:function(t,e){var i=t.options.range||this.viewPortSize.height,n=t.options.speed,o=window.parseInt(n*i*(e-.5));return o},extend:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},removeEvents:function(){o(document).off("relativity:update",o.proxy(this.onUpdateRelativity,this)),o(window).off("scroll",o.proxy(this.onWindowScroll,this)),o(window).off("resize",o.proxy(this.onUpdateRelativity,this))},uninitialize:function(){this.removeEvents()},vendorPrefix:function(){var t,e=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,i=o("script")[0].style,n="";for(t in i)if(e.test(t)){n=t.match(e)[0];break}return"WebkitOpacity"in i&&(n="Webkit"),"KhtmlOpacity"in i&&(n="Khtml"),function(t){return n+(n.length>0?t.charAt(0).toUpperCase()+t.slice(1):t)}}()},t.exports=n},function(e,i){e.exports=t}])});